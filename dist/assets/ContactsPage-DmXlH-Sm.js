import{j as e}from"./query-CI96NRWO.js";import{f as O,r as i}from"./vendor-CfbYkwfL.js";import{c as x,g as D,f as L}from"./index-Dy3KKWzm.js";import{u as F,a as U,g as $,C as R,b as Q,c as z}from"./ContactFormModal-BWhlEe2_.js";import{I as B,C as G,a as H}from"./ImportExportModal-FFJ0PqcP.js";import{H as J,i as K,g as X,U as q,J as V,n as W,P as Y,N as Z,a as ee,C as te}from"./ui-BbExp1x0.js";import"./supabase-BZ0N5lZN.js";const j=["from-emerald-400 to-emerald-600","from-blue-400 to-blue-600","from-purple-400 to-purple-600","from-amber-400 to-amber-600","from-pink-400 to-pink-600","from-indigo-400 to-indigo-600","from-teal-400 to-teal-600","from-rose-400 to-rose-600"];function se(d){let s=0;for(let l=0;l<d.length;l++)s=d.charCodeAt(l)+((s<<5)-s);return j[Math.abs(s)%j.length]}const ae={active:{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-100"},lead:{bg:"bg-blue-50",text:"text-blue-700",border:"border-blue-100"},customer:{bg:"bg-emerald-50",text:"text-emerald-700",border:"border-emerald-100"},inactive:{bg:"bg-gray-50",text:"text-gray-500",border:"border-gray-100"},prospect:{bg:"bg-amber-50",text:"text-amber-700",border:"border-amber-100"},churned:{bg:"bg-red-50",text:"text-red-600",border:"border-red-100"}},re={bg:"bg-gray-50",text:"text-gray-500",border:"border-gray-100"};function me(){const d=O(),[s,l]=i.useState(1),[c,N]=i.useState(""),[m,v]=i.useState(""),[w,g]=i.useState(!1),[C,b]=i.useState(!1),[S,k]=i.useState([]),P=i.useMemo(()=>({search:c||void 0,status:m||void 0}),[c,m]),{data:h,isLoading:_,error:u}=F(P,{page:s,pageSize:25,sortBy:"created_at",sortOrder:"desc"}),A=U(),y=h?.data??[],o=h?.totalPages??1,f=h?.count??0,E=(s-1)*25+1,M=Math.min(s*25,f);return e.jsxs("div",{className:"space-y-5 max-w-[1400px]",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Contact Directory"}),e.jsx("p",{className:"text-sm font-medium text-gray-500 mt-1",children:"Manage and track your high-value sales relationships."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:async()=>{const t=await $();k(t),b(!0)},className:"flex items-center gap-2 rounded-lg border border-gray-200 bg-white px-3.5 py-2 text-sm font-medium text-gray-700 shadow-sm transition-colors hover:bg-gray-50",children:[e.jsx(J,{className:"h-4 w-4 text-gray-400"}),"Import / Export"]}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 rounded-xl bg-[#1a1f36] px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-gray-900/10 transition-all hover:bg-[#252b45] hover:shadow-xl hover:scale-[1.02] active:scale-[0.98]",children:[e.jsx(K,{className:"h-4 w-4"}),"New Contact"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(X,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:c,onChange:t=>{N(t.target.value),l(1)},placeholder:"Search by name, email, or company...",className:"h-10 w-full rounded-lg border border-gray-200 bg-white pl-10 pr-4 text-sm text-gray-700 outline-none transition-all placeholder:text-gray-400 focus:border-emerald-400 focus:ring-2 focus:ring-emerald-500/10"})]}),e.jsx("div",{className:"flex items-center gap-1.5",children:["","active","lead","customer","inactive"].map(t=>{const a=t===""?"All":t.charAt(0).toUpperCase()+t.slice(1);return e.jsx("button",{onClick:()=>{v(t),l(1)},className:x("rounded-lg px-3 py-1.5 text-xs font-semibold transition-all",m===t?"bg-gray-900 text-white shadow-sm":"bg-white text-gray-500 border border-gray-200 hover:bg-gray-50"),children:a},t)})}),e.jsxs("div",{className:"ml-auto text-xs text-gray-400 font-medium",children:["Showing ",E," to ",M," of ",f," results"]})]}),e.jsx("div",{className:"rounded-xl border border-gray-100 bg-white shadow-sm overflow-hidden",children:_?e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"space-y-4",children:Array.from({length:8}).map((t,a)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 animate-pulse rounded-full bg-gray-50"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-3 w-1/3 animate-pulse rounded bg-gray-50"}),e.jsx("div",{className:"h-2 w-1/4 animate-pulse rounded bg-gray-50"})]})]},a))})}):u?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-red-500",children:[e.jsx("p",{className:"text-sm font-medium",children:"Error loading contacts"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:String(u)})]}):y.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx("div",{className:"rounded-full bg-gray-50 p-6 mb-4",children:e.jsx(q,{className:"h-10 w-10 opacity-30"})}),e.jsx("p",{className:"text-base font-medium text-gray-600 mb-1",children:"No contacts found"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:c?"Try a different search term":"Add your first contact to get started"}),e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 rounded-xl bg-emerald-500 px-4 py-2 text-sm font-semibold text-white shadow-lg shadow-emerald-500/20 transition-all hover:bg-emerald-600",children:[e.jsx(V,{className:"h-4 w-4"}),"Add Contact"]})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-100 bg-gray-50/80",children:[e.jsx("th",{className:"px-5 py-3 text-left text-[11px] font-bold uppercase tracking-[0.1em] text-gray-400",children:"Contact"}),e.jsx("th",{className:"px-5 py-3 text-left text-[11px] font-bold uppercase tracking-[0.1em] text-gray-400",children:"Status"}),e.jsx("th",{className:"px-5 py-3 text-left text-[11px] font-bold uppercase tracking-[0.1em] text-gray-400",children:"Position"}),e.jsx("th",{className:"px-5 py-3 text-left text-[11px] font-bold uppercase tracking-[0.1em] text-gray-400",children:"Phone"}),e.jsx("th",{className:"px-5 py-3 text-left text-[11px] font-bold uppercase tracking-[0.1em] text-gray-400",children:"Lead Score"}),e.jsx("th",{className:"px-5 py-3 text-left text-[11px] font-bold uppercase tracking-[0.1em] text-gray-400",children:"Added"}),e.jsx("th",{className:"px-5 py-3 text-right text-[11px] font-bold uppercase tracking-[0.1em] text-gray-400",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:y.map(t=>{const a=`${t.first_name??""} ${t.last_name??""}`.trim()||"Sin nombre",r=D(a),T=se(a),I=t.status?.toLowerCase()??"inactive",p=ae[I]??re;return e.jsxs("tr",{onClick:()=>d(`/contacts/${t.id}`),className:"group cursor-pointer transition-colors hover:bg-gray-50/80",children:[e.jsx("td",{className:"px-5 py-3.5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:x("flex h-9 w-9 shrink-0 items-center justify-center rounded-full bg-gradient-to-br text-xs font-semibold text-white shadow-sm",T),children:r}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 group-hover:text-emerald-600 transition-colors",children:a}),e.jsx("p",{className:"text-xs text-gray-400",children:t.email??"—"})]})]})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("span",{className:x("inline-flex items-center rounded-full border px-2.5 py-0.5 text-[11px] font-semibold uppercase tracking-wide",p.bg,p.text,p.border),children:R.find(n=>n.value===t.status)?.label??t.status??"—"})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("span",{className:"text-sm text-gray-700",children:t.job_title??"—"})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("span",{className:"text-sm text-gray-500 font-mono text-xs",children:t.phone_mobile??"—"})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("span",{className:"text-sm text-gray-500",children:t.lead_score!=null?t.lead_score:"—"})}),e.jsx("td",{className:"px-5 py-3.5",children:e.jsx("span",{className:"text-sm text-gray-500",children:L(t.created_at)})}),e.jsx("td",{className:"px-5 py-3.5 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),window.location.href=`mailto:${t.email}`},className:"rounded-lg p-1.5 text-gray-400 hover:bg-emerald-50 hover:text-emerald-600 transition-colors",title:"Send Email",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),window.location.href=`tel:${t.phone_mobile}`},className:"rounded-lg p-1.5 text-gray-400 hover:bg-blue-50 hover:text-blue-600 transition-colors",title:"Call",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),confirm("¿Eliminar este contacto?")&&A.mutate(t.id)},className:"rounded-lg p-1.5 text-gray-400 hover:bg-red-50 hover:text-red-500 transition-colors",title:"Delete",children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},t.id)})})]})}),o>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-xs text-gray-400",children:["Page ",s," of ",o]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:()=>l(Math.max(1,s-1)),disabled:s===1,className:"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-200 text-gray-400 transition-colors hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(ee,{className:"h-4 w-4"})}),Array.from({length:Math.min(o,5)}).map((t,a)=>{let r;return o<=5||s<=3?r=a+1:s>=o-2?r=o-4+a:r=s-2+a,e.jsx("button",{onClick:()=>l(r),className:x("flex h-8 w-8 items-center justify-center rounded-lg text-xs font-semibold transition-colors",s===r?"bg-gray-900 text-white shadow-sm":"text-gray-500 hover:bg-gray-50"),children:r},r)}),e.jsx("button",{onClick:()=>l(Math.min(o,s+1)),disabled:s===o,className:"flex h-8 w-8 items-center justify-center rounded-lg border border-gray-200 text-gray-400 transition-colors hover:bg-gray-50 disabled:opacity-30 disabled:cursor-not-allowed",children:e.jsx(te,{className:"h-4 w-4"})})]})]}),w&&e.jsx(Q,{onClose:()=>g(!1)}),C&&e.jsx(B,{entityType:"contacts",entityLabel:"Contactos",fields:H,exportColumns:G,exportData:S,onImport:z,onClose:()=>b(!1)})]})}export{me as ContactsPage};
