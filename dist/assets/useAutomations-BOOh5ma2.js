import{u,b as i,c as s}from"./query-CI96NRWO.js";import{s as o}from"./index-Dy3KKWzm.js";async function l(){const{data:t,error:e}=await o.from("automations").select("*").order("created_at",{ascending:!1});if(e)throw e;return t??[]}async function m(t){const{data:e,error:a}=await o.from("automations").select("*").eq("id",t).single();if(a)throw a;return e}async function d(t){const{data:e,error:a}=await o.from("automations").insert(t).select().single();if(a)throw a;return e}async function c(t,e){const{data:a,error:r}=await o.from("automations").update(e).eq("id",t).select().single();if(r)throw r;return a}async function f(t){const{error:e}=await o.from("automations").delete().eq("id",t);if(e)throw e}async function y(t,e){return c(t,{is_active:e})}async function q(t){const{data:e,error:a}=await o.from("automation_logs").select("*").eq("automation_id",t).order("executed_at",{ascending:!1}).limit(50);if(a)throw a;return e??[]}const n={all:["automations"],list:()=>[...n.all,"list"],detail:t=>[...n.all,"detail",t],logs:t=>[...n.all,"logs",t]};function w(){return u({queryKey:n.list(),queryFn:l,staleTime:1e3*60*5})}function K(t){return u({queryKey:n.detail(t),queryFn:()=>m(t),enabled:!!t})}function Q(t){return u({queryKey:n.logs(t),queryFn:()=>q(t),enabled:!!t,staleTime:1e3*60*2})}function p(){const t=i();return s({mutationFn:e=>d(e),onSuccess:()=>t.invalidateQueries({queryKey:n.list()})})}function v(){const t=i();return s({mutationFn:({id:e,data:a})=>c(e,a),onSuccess:(e,a)=>{t.invalidateQueries({queryKey:n.list()}),t.invalidateQueries({queryKey:n.detail(a.id)})}})}function F(){const t=i();return s({mutationFn:e=>f(e),onSuccess:()=>t.invalidateQueries({queryKey:n.list()})})}function _(){const t=i();return s({mutationFn:({id:e,isActive:a})=>y(e,a),onSuccess:(e,a)=>{t.invalidateQueries({queryKey:n.list()}),t.invalidateQueries({queryKey:n.detail(a.id)})}})}export{_ as a,F as b,p as c,Q as d,K as e,v as f,w as u};
